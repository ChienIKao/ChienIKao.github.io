<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Nothing is true, everything is permitted" href="https://chienikao.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Nothing is true, everything is permitted" href="https://chienikao.github.io/atom.xml"><link rel="alternate" type="application/json" title="Nothing is true, everything is permitted" href="https://chienikao.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="System Software,Assembler"><link rel="canonical" href="https://chienikao.github.io/2023/04/26/SystemSoftware/Ch02_Assembler/"><title>Ch02 - Assemblers - SystemSoftware | ChienI Kao = Nothing is true, everything is permitted</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Ch02 - Assemblers</h1><div class="meta"><span class="item" title="Created: 2023-04-26 09:33:29"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2023-04-26T09:33:29+08:00">2023-04-26</time> </span><span class="item" title="Symbols count in article"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">Symbols count in article</span> <span>21k</span> <span class="text">words</span> </span><span class="item" title="Reading time"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">Reading time</span> <span>19 mins.</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ChienI Kao</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1giph4wqtg4j20zk0m8x6p.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1giclwrdwyaj20zk0m8are.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1gicis3attqj20zk0m8k7l.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1gicmnywqgpj20zk0m8dwx.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1gipesrnqv3j20zk0m8ava.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1giclgi503lj20zk0m8hdt.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/SystemSoftware/" itemprop="item" rel="index" title="In SystemSoftware"><span itemprop="name">SystemSoftware</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="en"><link itemprop="mainEntityOfPage" href="https://chienikao.github.io/2023/04/26/SystemSoftware/Ch02_Assembler/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="ChienI Kao"><meta itemprop="description" content=", This is a note blog"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Nothing is true, everything is permitted"></span><div class="body md" itemprop="articleBody"><p><img data-src="https://i.imgur.com/hSiRp3g.png" alt=""></p><h2 id="introduction"><a class="anchor" href="#introduction">#</a> Introduction</h2><p>Design and implementation of assemblers</p><ul><li>Some <strong>common fundamental functions</strong> such as:<ul><li>translating <strong>mnemonic operation codes</strong> to their <strong>machine language</strong> equivalents</li><li>assigning machine <strong>addresses</strong> to <strong>symbolic labels</strong> used by the programmer.</li></ul></li><li>The features and design of an assembler depend heavily upon the source language it translates and the machine language it produces.</li><li><strong>Machine dependent/independent features</strong></li></ul><h2 id="basic-assembler-functions"><a class="anchor" href="#basic-assembler-functions">#</a> Basic Assembler Functions</h2><ul><li><p><a target="_blank" rel="noopener" href="http://localhost:4000/2023/04/26/System%20Software/Ch02/Ch02_example/"><strong>Example of SIC assembler language program</strong></a></p></li><li><p><strong>Assembler Directive</strong>: 在組語程式中，用來告訴 Assembler 某些資訊或是該做哪些動作，不屬於 CPU 的指令</p><ul><li><code>START</code> : specify <strong>name</strong> and <strong>starting address</strong> for the program.</li><li><code>END</code> : indicate the <strong>end of the source program</strong> and (optionally) specify the first executable instruction in the program.</li><li><strong>Variable/Constant Declaration</strong><ul><li><code>BYTE</code></li><li><code>WORD</code></li><li><code>RESB</code></li><li><code>RESW</code></li></ul></li></ul></li><li><p>The line numbers are for reference only and are not part of the program</p></li></ul><h3 id="a-simple-sic-assembler"><a class="anchor" href="#a-simple-sic-assembler">#</a> A Simple SIC Assembler</h3><ul><li>The translation of source program to object code requires us to accomplish the following functions<br>(not necessarily in the order given)<ol><li>Convert <strong>mnemonic operation codes</strong> to their machine <strong>language equivalents</strong><ul><li>translate STL to 14 (line 10)</li></ul></li><li>Convert <strong>symbolic operands</strong> to their equivalent <strong>machine addresses</strong><ul><li>translate RETADR to 1033 (line 10)</li></ul></li><li>Build the <strong>machine instruction</strong> in the <strong>proper format</strong>.</li><li>Convert the <strong>data constants</strong> specified in the source program into their <strong>internal machine representations</strong><ul><li>translate EOF to 454F46 (line 80)</li></ul></li><li><strong>Write the object program</strong> and the <strong>assembly listing</strong>.</li></ol></li></ul><h3 id="forward-reference-two-passes"><a class="anchor" href="#forward-reference-two-passes">#</a> Forward Reference &amp; Two Passes</h3><ul><li>The instruction at line 10 contains a <span class="red">forward reference</span>.<ul><li>Line 10 存取 <code>RETADR</code> ，但 <code>RETADR</code> 在 line 95 才定義</li></ul></li><li>Because of forward reference, most assemblers make <strong>two passes</strong> over the source program.<ul><li><strong>The first pass</strong>:<ul><li>does little more than scan the source program for <strong>label definitions</strong> and <strong>assign addresses</strong>.</li></ul></li><li><strong>The second pass</strong>:<ul><li>performs most of the <strong>actual translation</strong> previously described.</li></ul></li></ul></li><li>In addition, the assembler must <strong>process statements</strong> called <span class="red">assembler directives</span> (or <span class="red">pseudo-instructions</span>).</li></ul><h3 id="simple-object-program"><a class="anchor" href="#simple-object-program">#</a> Simple Object Program</h3><ul><li>The simple object program format we use contains <strong>three types of records</strong>.<ul><li><strong>Header</strong><ul><li>program name</li><li>starting address</li><li>length</li></ul></li><li><strong>Text</strong><ul><li>translated instructions</li><li>data</li><li>indication of the addresses where these are to be loaded</li></ul></li><li><strong>End</strong><ul><li>marks the end of the object program</li><li>specifies the address in the program where execution is to begin</li></ul></li></ul></li></ul><p><strong>Header record</strong>:</p><ul><li>Col. 1: H</li><li>Col. 2-7: Program name</li><li>Col. 8-13: starting address of object program</li><li>Col. 14-19: length of object program in bytes</li></ul><p><strong>Text record</strong>:</p><ul><li>Col. 1: T</li><li>Col. 2-7: starting address for object code in this record</li><li>Col. 8-9: length of object code in this record in bytes</li><li>Col. 10-69: object code, represented in <strong>hexadecimal</strong></li></ul><div class="note info"><ul><li>Object code 的部分可以容納 60 個 <strong>symbol</strong>（每個 4 bit），若以 byte 計算就是 30 bytes。</li><li>一個 instruction 長 3 bytes，所以可以放 10 個 instructions</li><li>在指令不連續時（通常是中間有宣告變數），會在沒填滿的情況下使用新的 text record。</li></ul></div><p><strong>End record</strong>:</p><ul><li>Col.1: E</li><li>Col. 2-7: address of first executable instruction in object program</li></ul><p><img data-src="https://i.imgur.com/K3uyzDu.jpg" alt=""></p><ul><li>There is no object code corresponding to addresses 1033-2038.</li><li>This storage is simply reserved by the loader for use by the program during execution.</li></ul><h3 id="two-passes"><a class="anchor" href="#two-passes">#</a> Two Passes</h3><p><strong>Pass 1</strong> (define symbols):</p><ul><li><strong>Assign addresses</strong> to all <strong>statements</strong> in the program.</li><li>Save the values (addresses) assigned to all <strong>labels</strong> for use in Pass 2.</li><li>Perform some <strong>processing of assembler directives</strong>.<ul><li>e.g., <strong>determining the length of data areas</strong> defined by BYTE, RESW, etc.)</li></ul></li></ul><p><strong>Pass 2</strong> (assemble instructions and generate object program):</p><ul><li>Assemble <strong>instructions</strong> (translating operation codes and looking up addresses)</li><li>Generate <strong>data values</strong> defined by BYTE, WORD, etc.</li><li>Perform processing of assembler directives not done during Pass 1.</li><li>Write the object program and the assembly listing.</li></ul><h2 id="assembler-algorithm-and-data-structures"><a class="anchor" href="#assembler-algorithm-and-data-structures">#</a> Assembler Algorithm and Data Structures</h2><p>Major internal data structures of simple assembler:</p><ul><li><strong>Operation code table</strong> (OPTAB)</li><li>Symbol table (SYMTAB)</li><li>Location Counter (LOCCTR)<ul><li><strong>Initialized to the beginning address</strong> specified in the START statement.</li></ul></li></ul><h3 id="operation-code-table-optab"><a class="anchor" href="#operation-code-table-optab">#</a> Operation Code Table (OPTAB)</h3><ul><li>Contains (at least) the <strong>mnemonic operation code</strong> and its <strong>machine language equivalents</strong><ul><li>In more complex assemblers, this table also contains information about instruction format and length.</li></ul></li><li>OPTAB is usually organized as a <strong>hash table</strong>, with <strong>mnemonic operation code as the <span class="red">key</span></strong>.<ul><li>The information in OPTAB is <strong>predefined</strong> when the assembler itself is written.</li></ul></li></ul><p><strong>Example of OPTAB</strong></p><table><thead><tr><th style="text-align:left">Mnemonic</th><th style="text-align:left">Machine Language</th></tr></thead><tbody><tr><td style="text-align:left"><code>ADD</code></td><td style="text-align:left">18</td></tr><tr><td style="text-align:left"><code>ADDF</code></td><td style="text-align:left">58</td></tr><tr><td style="text-align:left"><code>ADDR</code></td><td style="text-align:left">90</td></tr><tr><td style="text-align:left">…</td><td style="text-align:left">…</td></tr></tbody></table><div class="note info"><ul><li>Operation code table 的內容不太會變動</li><li>使用目的是用來加快 mnemonic <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">⇒</span></span></span></span> machine language 的速度<ul><li>需要使用<strong>查詢</strong>速度很快的資料結構</li></ul></li><li>所以會使用 Hash Table 來實作 OPTAB<ul><li>查詢的平均複雜度是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></div><h3 id="symbol-table-symtab"><a class="anchor" href="#symbol-table-symtab">#</a> Symbol Table (SYMTAB)</h3><ul><li>Includes the <strong>name</strong> and <strong>value (address)</strong> for each <strong>label</strong> in the source program<ul><li>together with <strong>flags</strong> to indicate <span class="red">error conditions</span><ul><li>e.g., a symbol defined in two different places</li></ul></li></ul></li><li>It may also contain other information about the data area or instruction labeled<ul><li>for example, its <strong>type</strong> or <strong>length</strong>.</li></ul></li><li>During <span class="red">Pass 1</span><ul><li><strong>labels</strong> are entered into SYMTAB as they are encountered in the source program</li><li>along with their <strong>assigned addresses</strong>.</li></ul></li><li>During <span class="red">Pass 2</span><ul><li>symbols used as <strong>operands</strong> are <strong>looked up in SYMTAB</strong><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">⇒</span></span></span></span> <strong>the addresses</strong> to be inserted in the assembled instructions.</li></ul></li><li>SYMTAB is usually organized as a <strong>hash table</strong><ul><li>for <strong>efficiency</strong> of <span class="red">insertion</span> and <span class="red">retrieval</span>.</li></ul></li><li>Since entries are rarely deleted from this table, efficiency of deletion is not an important consideration.</li></ul><p><strong>Example: SYMTAB of <a href="./Ch02%20-%20%E7%AF%84%E4%BE%8B%E7%A8%8B%E5%BC%8F.md">SIC Program</a></strong></p><table><thead><tr><th style="text-align:left">Label</th><th style="text-align:left">Location</th></tr></thead><tbody><tr><td style="text-align:left"><code>COPY</code></td><td style="text-align:left">1000</td></tr><tr><td style="text-align:left"><code>FIRST</code></td><td style="text-align:left">1000</td></tr><tr><td style="text-align:left"><code>CLOOP</code></td><td style="text-align:left">1003</td></tr><tr><td style="text-align:left"><code>ENDFIL</code></td><td style="text-align:left">1015</td></tr><tr><td style="text-align:left"><code>EOF</code></td><td style="text-align:left">102A</td></tr><tr><td style="text-align:left"><code>THREE</code></td><td style="text-align:left">102D</td></tr><tr><td style="text-align:left">…</td><td style="text-align:left">…</td></tr></tbody></table><div class="note info"><p>對 hash table 來說，<strong>insertion</strong> (插入) 和 <strong>retrieval</strong> (查詢)，平均複雜度都是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p></div><h3 id="hash-table"><a class="anchor" href="#hash-table">#</a> Hash Table</h3><ul><li>Care should be taken in the selection of a hashing function.<ul><li>Programmers often select many <strong>labels</strong> that have <strong>similar characteristics</strong><ul><li>for example, labels that start or end with the same characters (like LOOP1, LOOP2, LOOPA).</li></ul></li><li>It is important that the hashing function used perform well with such non-random keys.<ul><li>對於任意的 key，hash 的結果越不容易重複越好</li></ul></li><li>Division of the entire key by a <strong>prime table length</strong> often gives good results.</li></ul></li></ul><h3 id="algorithms-of-passes"><a class="anchor" href="#algorithms-of-passes">#</a> Algorithms of Passes</h3><p>Pass 1 usually writes an <span class="red">intermediate file</span></p><ul><li>contains each <strong>source statement</strong> together with its <strong>assigned addresses</strong>, <strong>error indicators</strong>, etc.</li><li>This file is used <strong>as the input to Pass 2</strong>.</li></ul><p><strong>Pseudo Code of Pass1</strong></p><figure class="highlight vhdl"><figcaption data-lang="VHDL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">begin</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    read first input line</pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'START' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="5"></td><td><pre>            save #<span class="token punctuation">[</span>OPERAND<span class="token punctuation">]</span> as starting address</pre></td></tr><tr><td data-num="6"></td><td><pre>            initialize LOCCTR <span class="token keyword">to</span> starting address</pre></td></tr><tr><td data-num="7"></td><td><pre>            write line <span class="token keyword">to</span> intermediate <span class="token keyword">file</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            read <span class="token keyword">next</span> input line</pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> START<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        initialize LOCCTR <span class="token keyword">to</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">while</span> OPCODE !<span class="token operator">=</span> '<span class="token keyword">END</span>' do</pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token keyword">if</span> this <span class="token keyword">is</span> <span class="token operator">not</span> a comment line <span class="token keyword">then</span></pre></td></tr><tr><td data-num="15"></td><td><pre>                <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                    <span class="token keyword">if</span> there <span class="token keyword">is</span> a symbol <span class="token keyword">in</span> the <span class="token keyword">LABEL</span> field <span class="token keyword">then</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                            search SYMTAB <span class="token keyword">for</span> <span class="token keyword">LABEL</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                            <span class="token keyword">if</span> found <span class="token keyword">then</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                                set error flag <span class="token punctuation">(</span>duplicate symbol<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                            <span class="token keyword">else</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                                insert <span class="token punctuation">(</span><span class="token keyword">LABEL</span><span class="token punctuation">,</span> LOCCTR<span class="token punctuation">)</span> into SYMTAB</pre></td></tr><tr><td data-num="23"></td><td><pre>                        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> symbol<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                    search OPTAB <span class="token keyword">for</span> OPCODE</pre></td></tr><tr><td data-num="25"></td><td><pre>                    <span class="token keyword">if</span> found <span class="token keyword">then</span></pre></td></tr><tr><td data-num="26"></td><td><pre>                        add <span class="token number">3</span> <span class="token punctuation">&#123;</span>instruction length<span class="token punctuation">&#125;</span> <span class="token keyword">to</span> LOCCTR</pre></td></tr><tr><td data-num="27"></td><td><pre>                    <span class="token keyword">else</span> <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'WORD ' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                        add <span class="token number">3</span> <span class="token keyword">to</span> LOCCTR</pre></td></tr><tr><td data-num="29"></td><td><pre>                    <span class="token keyword">else</span> <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'RESW' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="30"></td><td><pre>                        add <span class="token number">3</span> <span class="token operator">*</span> #<span class="token punctuation">[</span>OPERAND<span class="token punctuation">]</span> <span class="token keyword">to</span> LOCCTR</pre></td></tr><tr><td data-num="31"></td><td><pre>                    <span class="token keyword">else</span> <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'RESB' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="32"></td><td><pre>                        add #<span class="token punctuation">[</span>OPERAND<span class="token punctuation">]</span> <span class="token keyword">to</span> LOCCTR</pre></td></tr><tr><td data-num="33"></td><td><pre>                    <span class="token keyword">else</span> <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'BYTE' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="34"></td><td><pre>                        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="35"></td><td><pre>                            find length <span class="token keyword">of</span> <span class="token keyword">constant</span> <span class="token keyword">in</span> bytes</pre></td></tr><tr><td data-num="36"></td><td><pre>                            add length <span class="token keyword">to</span> LOCCTR</pre></td></tr><tr><td data-num="37"></td><td><pre>                        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> BYTE<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="39"></td><td><pre>                        set error flag <span class="token punctuation">(</span>invalid operation code<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>                <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token operator">not</span> a comment<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>            write line <span class="token keyword">to</span> intermediate <span class="token keyword">file</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            read <span class="token keyword">next</span> input line</pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token operator">not</span> <span class="token keyword">END</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    write last line <span class="token keyword">to</span> intermediate <span class="token keyword">file</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    save <span class="token punctuation">(</span>LOCCTR <span class="token operator">-</span> starting address<span class="token punctuation">)</span> as program length</pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">end</span> <span class="token punctuation">&#123;</span>Pass <span class="token number">1</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>Presudo Code of Pass2</strong></p><figure class="highlight vhdl"><figcaption data-lang="VHDL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">begin</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    read first input line <span class="token punctuation">&#123;</span>from intermediate <span class="token keyword">file</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'START' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="5"></td><td><pre>            Write listing line</pre></td></tr><tr><td data-num="6"></td><td><pre>            read <span class="token keyword">next</span> input line</pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> START<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    write Header <span class="token keyword">record</span> <span class="token keyword">to</span> object program</pre></td></tr><tr><td data-num="9"></td><td><pre>    initialize first Text <span class="token keyword">record</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">while</span> OPCODE !<span class="token operator">=</span> '<span class="token keyword">END</span>' do</pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token keyword">if</span> this <span class="token keyword">is</span> <span class="token operator">not</span> a comment line <span class="token keyword">then</span></pre></td></tr><tr><td data-num="13"></td><td><pre>                <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="14"></td><td><pre>                    search OPTAB <span class="token keyword">for</span> OPCODE</pre></td></tr><tr><td data-num="15"></td><td><pre>                    <span class="token keyword">if</span> found <span class="token keyword">then</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                            <span class="token keyword">if</span> there <span class="token keyword">is</span> a symbol <span class="token keyword">in</span> OPERAND field <span class="token keyword">then</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                                <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                                    search SYMTAB <span class="token keyword">for</span> OPERAND</pre></td></tr><tr><td data-num="20"></td><td><pre>                                    <span class="token keyword">if</span> found <span class="token keyword">then</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                                        store symbol value as operand address</pre></td></tr><tr><td data-num="22"></td><td><pre>                                    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                                        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                                            store <span class="token number">0</span> as operand address</pre></td></tr><tr><td data-num="25"></td><td><pre>                                            set error flag <span class="token punctuation">(</span>undefined symbol<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>                                        <span class="token keyword">end</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                                <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> symbol<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                            <span class="token keyword">else</span></pre></td></tr><tr><td data-num="29"></td><td><pre>                                store <span class="token number">0</span> as operand address</pre></td></tr><tr><td data-num="30"></td><td><pre>                            assemble the object code instruction</pre></td></tr><tr><td data-num="31"></td><td><pre>                        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> opcode found<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>                    <span class="token keyword">else</span> <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'BYTE' <span class="token operator">or</span> 'WORD' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="33"></td><td><pre>                        convert <span class="token keyword">constant</span> <span class="token keyword">to</span> object code</pre></td></tr><tr><td data-num="34"></td><td><pre>                    <span class="token keyword">if</span> object code will <span class="token operator">not</span> fit into the current Text <span class="token keyword">record</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="35"></td><td><pre>                        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="36"></td><td><pre>                            write Text <span class="token keyword">record</span> <span class="token keyword">to</span> object program</pre></td></tr><tr><td data-num="37"></td><td><pre>                            initialize <span class="token keyword">new</span> Text <span class="token keyword">record</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                        <span class="token keyword">end</span></pre></td></tr><tr><td data-num="39"></td><td><pre>                    add object code <span class="token keyword">to</span> Text <span class="token keyword">record</span></pre></td></tr><tr><td data-num="40"></td><td><pre>                <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token operator">not</span> comment <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>            write listing line</pre></td></tr><tr><td data-num="42"></td><td><pre>            read <span class="token keyword">next</span> input line</pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token operator">not</span> <span class="token keyword">END</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    write last Text <span class="token keyword">record</span> <span class="token keyword">to</span> object program</pre></td></tr><tr><td data-num="45"></td><td><pre>    write <span class="token keyword">End</span> <span class="token keyword">record</span> <span class="token keyword">to</span> object program</pre></td></tr><tr><td data-num="46"></td><td><pre>    write last listing line</pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">end</span> <span class="token punctuation">&#123;</span>Pass <span class="token number">2</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="machine-dependent-assembler-features"><a class="anchor" href="#machine-dependent-assembler-features">#</a> Machine-Dependent Assembler Features</h2><ul><li><p><a target="_blank" rel="noopener" href="http://localhost:4000/2023/04/26/System%20Software/Ch02/Ch02_example/"><strong>Example of SIC/XE Program</strong></a></p></li><li><p>The <strong>assembler directive</strong> <code>BASE</code> is used in conjunction with <strong>base relative addressing</strong>.</p><ul><li>用 <code>BASE</code> 讓 assembler 知道 base register 的值</li><li>Assembler 必須知道 base 的值，才能計算指令中的 displacement</li></ul></li><li><p>If the <strong>displacements</strong> required for relative addressing are <strong>too large</strong> to fit into a <strong>3-byte instruction</strong><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">⇒</span></span></span></span> the <strong>4-byte extended format</strong> (Format 4) must be used.</p><ul><li>The <strong>bit e is set to 1</strong> to indicate extended instruction format.</li><li>The extended instruction format is <strong>specified with the prefix +</strong> added to the <strong>operation code</strong> in the <span class="red">source statement</span>.</li><li>It is the <strong>programmer’s responsibility to specify</strong> this form of addressing when it is required.</li></ul></li><li><p>Advantages of the more advanced SIC/XE architecture to improve the execution speed of the program</p><ul><li><strong>Register-to-register instructions</strong> are faster than register-to-memory operations.</li><li>When using <strong>immediate addressing</strong>, the operand is already present as part of the instruction and <strong>need not be fetched from anywhere</strong>.</li><li>The use of <strong>indirect addressing</strong> often <strong>avoids the need for another instruction</strong>.</li></ul></li></ul><h3 id="instruction-formats-and-addressing-modes"><a class="anchor" href="#instruction-formats-and-addressing-modes">#</a> Instruction Formats and Addressing Modes</h3><ul><li><p>The conversion of <strong>register mnemonics</strong> to numbers can be done with a separate table</p><ul><li>however, it is often convenient to use the <strong>symbol table</strong> for this purpose.</li><li>To do this, SYMTAB would <strong>be preloaded with the register names</strong> and their values.</li></ul></li><li><p>If extended format is not specified, the assembler <strong>first</strong> attempts to translate the instruction using <strong>program-counter relative addressing</strong>.</p><ul><li>If this is not possible (because the required displacement is out of range), the assembler then attempts to use <strong>base relative addressing</strong>.</li><li>If neither form of relative addressing is applicable and extended format is not specified, then the instruction cannot be properly assembled.<ul><li>In this case, the assembler must generate an <span class="red">error message</span>.</li></ul></li></ul></li></ul><h3 id="displacement-calculation"><a class="anchor" href="#displacement-calculation">#</a> Displacement Calculation</h3><ul><li>The computation that the assembler needs to perform is essentially the target address calculation in reverse.<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>p</mi><mo>=</mo><mi>T</mi><mi>A</mi><mo>−</mo><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">disp = TA - (B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>p</mi><mo>=</mo><mi>T</mi><mi>A</mi><mo>−</mo><mo stretchy="false">(</mo><mi>P</mi><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">disp = TA - (PC)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><p><strong>PC Relative</strong></p><ul><li>The program counter is advanced after each instruction is fetched and before it is executed.<ul><li>Thus during the execution of an instruction, program counter will contain <strong>the address of the next instruction</strong>.</li></ul></li><li>The assembler knows what the contents of the program counter will be at execution time.</li></ul><p><strong>Base Relative</strong></p><ul><li>The base register is under control of the programmer.</li><li>The programmer must tell the assembler what the base register will contain during execution<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">⇒</span></span></span></span> so that the assembler can compute displacements.<ul><li>This is done with the <strong>assembler directive <code>BASE</code> </strong>.</li><li><code>NOBASE</code></li><li>These assembler directives produce no executable code.</li><li>The programmer must provide instructions that load the proper value into the base register during execution.</li></ul></li></ul><h3 id="program-relocation"><a class="anchor" href="#program-relocation">#</a> Program Relocation</h3><ul><li>It is often desirable to have <strong>more than one</strong> program at a time sharing the memory and other resources of the machine.<ul><li>In such situation the actual starting address of the program is not known until load time.</li><li><strong>Some address protions of the program need to be changed, while some parts (such as constants) should remain the same regardless of where the program is loaded.</strong></li><li>Looking at the object code alone, it is in general <strong>not possible</strong> to tell which values represent addresses and which represent constant data items.</li></ul></li><li>Since <strong>the assembler does not know the actual location</strong> where the program will be loaded, <strong>it cannot make the necessary changes</strong> in the addresses used by the program.</li><li>However, <strong>the assembler can identify for the loader those parts of the object program that need modification</strong>.</li></ul><p><strong>Example</strong></p><ul><li>We assembled this program using a starting address of <code>0000</code> .<ul><li>The <code>JSUB</code> instruction from line 15 is loaded at address <code>0006</code> .<br>The address field of this instruction contains <code>01036</code> , which is the address of the instruction labeled <code>RDREC</code> .</li><li>Now, suppose we want to load this program beginning at address <code>5000</code> .<br>The address of the instruction labeled <code>RDREC</code> is then <code>6036</code> .<br>Thus the <code>JSUB</code> instruction must be modified as shown to contain this new address.</li></ul></li></ul><p><img data-src="https://i.imgur.com/w3yW6U3.png" alt=""></p><ul><li><p>We can solve the relocation problem in the following way:</p><ul><li>When the assembler generates the object code, it will insert the address of <em>relative to the start of the program</em>.</li><li>The assembler will also produce a command for the loader, instructing it to <em>add</em> <strong>the beginning address</strong> of the program to the address field at load time.</li></ul></li><li><p><strong>Modification record</strong></p><ul><li>Col. 1: M</li><li>Col. 2-7: Starting location of the address field to be modified, relative to the beginning of the program.</li><li>Col. 8-9: Length of the address field to be modified, in <span class="red">half-bytes</span></li></ul></li><li><p>The length is stored in half-bytes (rather than bytes) because the address field to be modified may not occupy an integral number of bytes. (ex. the address field in the <code>JSUB</code> we considered above occupies 20 bits, which is 5 half-bytes)</p></li><li><p>If this field occupied an odd number of half-bytes, it is assumed to begin in the middle of the first byte at the starting location.</p></li></ul><p><img data-src="https://i.imgur.com/iSkmAdF.jpg" alt=""></p><ul><li><code>M00000705</code> for line 15</li></ul><h2 id="machine-independent-assembler-features"><a class="anchor" href="#machine-independent-assembler-features">#</a> Machine-Independent Assembler Features</h2><h3 id="literal-字定"><a class="anchor" href="#literal-字定">#</a> Literal (字定)</h3><pre><code>  - A literal is identified with the prefix `=`, which is followed by a specification of the literal value, using the same notation as in the *BYTE* statement.
</code></pre><ul><li>The effect of using a literal is exactly the same as if the programmer had defined the <strong>constant</strong> explicitly and used the label assigned to the constant as the instruction operand.</li><li>Difference between a literal and an immediate operand<ul><li>With <strong>immediate</strong> addressing, the operand value is assembled as part of the machine instruction.</li><li>With a <strong>literal</strong>, the assembler generates the specified value as a constant at some other memory location.</li></ul></li><li>All of the literal operands used in a program are gathered together into one or more <span class="red"><em>literal pools</em></span>. Normally literals are placed into a pool at the end of the program.</li><li>In some case, it is desirable to place literals into a pool at some other location in the object program. We use the assembler directive <code>LTORG</code> .<ul><li>When the assembler encounters a <code>LTORG</code> statement, <strong>it creates a literal pool that contains all of the literal operands used since the previous <code>LTORG</code> </strong>(or the beginning of the program).</li><li>This literal pool is placed in the object program at the location where the <code>LTORG</code> directive was encountered.</li></ul></li><li>If we had <strong>not used</strong> <code>LTORG</code> statement, literals would be placed in the pool at the end of the program. This means that <strong>the literal operand would be placed too far away from the instruction</strong> referencing it to allow program-counter relative addressing.</li><li><strong>Most assemblers recognize duplicate literals</strong> — that is, the same literal used in more than one place in the program — and store only one copy of the specified data value.</li></ul><p><strong>Literal Table LITTAB</strong></p><ul><li>This table contains the <strong>literal name, the operand value and length, and the address</strong> assigned to the operand when it is placed in a literal pool.</li><li><code>LITTAB</code> is often organized as a hash table, using the literal name or value as the key.</li><li>Pass 1:<ul><li>The assembler searches <code>LITTAB</code> for the specified literal name (or value). If the literal is already present in the table, no action is needed; if it is not present, the literal is added to <code>LITTAB</code> (<strong>leaving the address unassigned</strong>)</li><li>When pass 1 encounters a <code>LTORG</code> statement or the end of the program, the assembler makes a scan of the literal table. At this time each literal currently in the table is assigned an address (unless such an address has already been fill in).</li><li>As these addresses are assigned, the location counter is updated to reflect the number of bytes occupied by each literal.</li></ul></li><li>Pass 2:<ul><li>The operand address for use in generating object code is obtained by searching <code>LITTAB</code> for each literal operand encountered.</li></ul></li></ul><h3 id="symbol-defining-statements"><a class="anchor" href="#symbol-defining-statements">#</a> Symbol-Defining Statements</h3><p><strong>Symbol <span class="red"><code>EQU</code> </span>value</strong><br>The value may be given as a constant or as any expression involving constants and previously defined symbols.</p><ul><li><p><strong>One common use of <code>EQU</code> is to establish symbolic names that can be used for improved readability in place of numeric values</strong>.</p><ol><li><pre><code>+LDT  #4096
</code></pre></li><li><pre><code>MAXLEN  EQU  4096
+LDT   #MAXLEN
</code></pre></li></ol></li><li><p>The resulting object code is exactly the same as in the original version of the instruction; however, the source statement is easier to understand. It is also much easier to find and change the value of MAXLEN.</p></li><li><p>Another common use of <code>EQU</code> is in defining mnemonic names for registers.</p><pre><code>A  EQU 0
X  EQU 1
L  EQU 2
</code></pre></li></ul><h4 id="org-value"><a class="anchor" href="#org-value">#</a> <strong><code>ORG</code> value</strong></h4><p>Where value is a constant or an expression involving constants and previously defined symbols.</p><p>When this statement is encountered during assembly of a program, the assembler resets its location counter to the specified value.</p><ul><li><p>Consider a symbol table STAB with 100 entries, the SYMBOL field contains a 6-byte user-defined symbol; VALUE is a one-word representation of the value assigned to the symbol; FLAGS is a 2-byte field that specifies symbol type and other information.</p><ul><li><pre><code>STAB  RESB  1100
SYMBOL   EQU  STAB
VALUE    EQU   STAB+6
FLAGS   EQU   STAB+9
LDA   VALUE, X
</code></pre></li><li>However, this method of definition simply defines the labels; it does not make the structure of the table as clear as it might be.</li><li><pre><code>STAB   RESB   1100
       ORG    STAB
SYMBOL   RESB  6
VALUE    RESW  1
FLAGS    RESB  2
       ORG    STAB+1100
</code></pre></li><li>The last <code>ORG</code> statement is very important. It sets LOCCTR back to its previous value.</li><li>In some assemblers the previous value of LOCCTR is automatically remembered, so we can simply write<pre><code>ORG
</code></pre></li></ul></li><li><p>All symbols used on the right-hand side of the statement—that is, all terms used to specify the value of the new symbol—must have been defined previously in the program. (e.g., the following example would not be allowed)</p><ul><li><pre><code>BETA   EQU   ALPHA
ALPHA  RESW  1 
</code></pre></li></ul></li></ul><h3 id="expressions"><a class="anchor" href="#expressions">#</a> Expressions</h3><ul><li>Individual terms in the expression may be constants, user-defined symbols, or special terms (e.g., the value of the location counter)</li><li>The values of terms and expressions are either <span class="red">relative</span> or <span class="red">absolute</span>.<ul><li>A <strong>constant</strong> is, of course, an <strong>absolute</strong> term.</li><li>Labels on instructions and data areas, and references to the location counter value, are relative terms.</li></ul></li><li>An expression that contains only absolute terms is, of course, an absolute expression.</li><li><strong>Absolute</strong> expressions may also contain relative terms provided <strong>the relative terms occur in pairs and the terms in each such pair have opposite signs</strong>.<ul><li>None of the relative terms may enter into a multiplication or division operation.</li></ul></li><li>A relative expression is one in which all of the relative terms except one can be paired as described above; <strong>the remaining unpaired relative term must have a positive sign</strong>.</li><li>Absolute, relative, or error? (in Figure 2.10)<pre><code>0030   RETADR   RESW   1      Relative      // Absolute
0036   BUFFER   RESB   4096   Relative      // Absolute
1036   BUFFEND  EQU    *                    // Relative
1000   MAXLEN   EQU    BUFEND-BUFFER        // Absolute
BUFEND+BUFFER     // Error
100-BUFFER        // Error
3*BUFFER          // Error
</code></pre></li><li>We need a flag in the symbol table to indicate type of value (absolute or relative) in addition to the value itself.</li></ul><h3 id="program-blocks"><a class="anchor" href="#program-blocks">#</a> Program Blocks</h3><ul><li>We use the term <font>program blocks</font> to refer to segments of code that are rearranged within a single object program unit.</li><li>The assembler directive USE indicates which portions of the source program belong to the various blocks.</li><li><strong>Figure 2.11</strong><ul><li>The first (unnamed) program block contains the executable instructions of the program.</li><li>The second (named CDATA) contains all data areas that are a few words or less in length.</li><li>The third (named CBLKS) contains all data areas that consist of larger blocks of memory.</li></ul></li><li>The assembler will (logically) rearrange these segments to gather together the pieces of each block. These blocks will then be assigned addresses in the object program, with the blocks appearing in the same order in which they were first begun in the source program.</li><li>The assembler accomplishes this logical rearrangement of code by maintaining, during Pass 1, a separate location counter for each program block.</li><li>When labels are entered into the symbol table, the block name or number is stored along with the assigned relative address.</li><li>At the end of Pass 1 the latest value of the location counter for each block indicates the length of that block. The assembler can then assign to each block a starting address in the object program.</li><li>For code generation during Pass 2, the assembler simply adds the location of the symbol, relative to the start of its block, to the assigned block starting address.</li><li><strong>Figure 2.12</strong><ul><li>Notice that the value of the symbol MAXLEN (line 107) is shown without a block number. This indicates that MAXLEN is an absolute symbol, whose value is not relative to the start of any program block.</li><li>Line 20</li></ul></li><li>We can immediately see that the separation of the program into blocks has considerably reduced the addressing problems. Because the large buffer area is moved to the end of the object program, we no longer need to use extended format instructions on lines 15, 35, and 65.</li><li>Program <font>readability</font> is often improved if the definitions of data areas are placed in the source program close to the statements that reference them.</li><li>The use of program blocks is one way of satisfying both of these requirements, with the assembler providing the required reorganization.</li><li>It is not necessary to physically rearrange the generated code in the object program to place the pieces of each program block together. The assembler can simply write the object code as it is generated during Pass 2 and insert the proper load address in each Text record. The loader will simply load the object code from each record at the indicated address.<ul><li><p>Figure 2.13, Figure 2.14</p><p><img data-src="https://i.imgur.com/hmGOUb6.jpg" alt=""></p><p><img data-src="https://i.imgur.com/Sp87SNz.jpg" alt=""></p></li></ul></li></ul><h2 id="control-sections-and-program-linking"><a class="anchor" href="#control-sections-and-program-linking">#</a> Control Sections and Program Linking</h2><ul><li>A <font>control section</font> is a part of the program that maintains its identity after assembly; each such control section can be loaded and relocated independently of the others.</li><li>When control sections form logically related parts of a program, it is necessary to provide some means for <font>linking</font> them together.</li><li>Instructions in one control section might need to refer to instructions or data located in another section. The assembler is unable to process these references in the usual way. The assembler has no idea where any other control section will be located at execution. Such references between control sections are called <font>external references</font>.</li></ul><h3 id="figure-215"><a class="anchor" href="#figure-215">#</a> Figure 2.15</h3><ul><li><font>CSECT</font></li><li>Three control sections: <code>COPY</code> , <code>RDREC</code> , <code>WRREC</code></li><li>The assembler establishes a separate location counter for each control section, just as it does for program blocks.</li><li><font>EXTDEF</font> (external definition for external symbol)</li><li><font>EXTREF</font> (external reference)</li></ul><h3 id="figure-216"><a class="anchor" href="#figure-216">#</a> Figure 2.16</h3><ul><li><strong>Line 15:</strong><pre><code>15    0003    CLOOP     +JSUB	RDREC		4B100000
</code></pre></li><li><strong>Line 160</strong><pre><code>160   0017              +STCH	BUFFER,X	57900000
</code></pre></li><li><strong>Line 190</strong><pre><code>190   0028    MAXLEN    WORD	BUFEND-BUFFER	000000
</code></pre><ul><li>The assembler has no idea where the control section containing <code>RDREC</code> will be loaded, so it cannot assemble the address for this instruction. Instead the assembler inserts an address of zero and passes information to the loader, which will cause the proper address to be inserted at load time.</li><li>The address of <code>RDREC</code> will have no predictable relationship to anything in this control section therefore relative addressing is not possible. Thus an extended format instruction must be used to provide room for the actual address to be inserted.</li></ul></li><li>The assembler must also allow the same symbol to be used in different control sections.</li></ul><p><strong>Define record</strong></p><ul><li><strong>Col. 1:</strong> D</li><li><strong>Col. 2-7:</strong> name of external symbol defined in this control section</li><li><strong>Col. 8-13:</strong> relative address of symbol within this control section</li><li><strong>Col. 14-73:</strong> Repeat information in Col. 2-13 for other external symbols.</li></ul><p><strong>Refer record</strong></p><ul><li><strong>Col. 1:</strong> R</li><li><strong>Col. 2-7:</strong> name of external symbol referred to in this control section</li><li><strong>Col. 8-73:</strong> names of other external reference symbols</li></ul><p><strong>New format of the Modification record type</strong></p><ul><li><strong>Col. 1:</strong> M</li><li><strong>Col. 2-7:</strong> starting address of the field to be modified</li><li><strong>Col. 8-9:</strong> length of the field to be modified, in half-bytes</li><li><strong>Col. 10:</strong> Modification flag (+ or -)</li><li><strong>Col. 11-16:</strong> External symbol whose value is to be added to or subtracted from the indicated field.</li></ul><h3 id="figure-217"><a class="anchor" href="#figure-217">#</a> Figure 2.17</h3><ul><li>Our earlier definitions required that all of the relative terms in an expression be paired (for an absolute expression), or that all except one be paired (for a relative expression). We must now extend this restriction to specify that both terms in each pair must be relative within the same control section.</li><li>When an expression involves external references, the assembler cannot in general determine whether or not the expression is legal. Whether the terms occur in the same control section is unknown at assembly time. In such a case, the assembler generates Modification records so the loader can check the expression for errors.</li></ul><div class="tags"><a href="/tags/System-Software/" rel="tag"><i class="ic i-tag"></i> System Software</a> <a href="/tags/Assembler/" rel="tag"><i class="ic i-tag"></i> Assembler</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">Edited on</span> <time title="Modified: 2023-10-20 09:55:20" itemprop="dateModified" datetime="2023-10-20T09:55:20+08:00">2023-10-20</time></span></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>ChienI Kao <i class="ic i-at"><em>@</em></i>Nothing is true, everything is permitted</li><li class="link"><strong>Post link: </strong><a href="https://chienikao.github.io/2023/04/26/SystemSoftware/Ch02_Assembler/" title="Ch02 - Assemblers">https://chienikao.github.io/2023/04/26/SystemSoftware/Ch02_Assembler/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/04/26/Coding/leetcode/Easy/258%20Add%20Digits/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;i.imgur.com&#x2F;ZyRLKcd.jpeg" title="258. Add Digits"><span class="type">Previous Post</span> <span class="category"><i class="ic i-flag"></i> Easy</span><h3>258. Add Digits</h3></a></div><div class="item right"><a href="/2023/04/26/Coding/uva/Star1/uva%20706/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;21r000-image.oss-cn-shanghai.aliyuncs.com&#x2F;pic2021&#x2F;6833939bly1gipeun65urj20zk0m81ii.jpg" title="uva 706 - LC-Display"><span class="type">Next Post</span> <span class="category"><i class="ic i-flag"></i> Star1</span><h3>uva 706 - LC-Display</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#basic-assembler-functions"><span class="toc-number">2.</span> <span class="toc-text">Basic Assembler Functions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#a-simple-sic-assembler"><span class="toc-number">2.1.</span> <span class="toc-text">A Simple SIC Assembler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#forward-reference-two-passes"><span class="toc-number">2.2.</span> <span class="toc-text">Forward Reference &amp; Two Passes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#simple-object-program"><span class="toc-number">2.3.</span> <span class="toc-text">Simple Object Program</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#two-passes"><span class="toc-number">2.4.</span> <span class="toc-text">Two Passes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#assembler-algorithm-and-data-structures"><span class="toc-number">3.</span> <span class="toc-text">Assembler Algorithm and Data Structures</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#operation-code-table-optab"><span class="toc-number">3.1.</span> <span class="toc-text">Operation Code Table (OPTAB)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#symbol-table-symtab"><span class="toc-number">3.2.</span> <span class="toc-text">Symbol Table (SYMTAB)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hash-table"><span class="toc-number">3.3.</span> <span class="toc-text">Hash Table</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#algorithms-of-passes"><span class="toc-number">3.4.</span> <span class="toc-text">Algorithms of Passes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#machine-dependent-assembler-features"><span class="toc-number">4.</span> <span class="toc-text">Machine-Dependent Assembler Features</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#instruction-formats-and-addressing-modes"><span class="toc-number">4.1.</span> <span class="toc-text">Instruction Formats and Addressing Modes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#displacement-calculation"><span class="toc-number">4.2.</span> <span class="toc-text">Displacement Calculation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#program-relocation"><span class="toc-number">4.3.</span> <span class="toc-text">Program Relocation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#machine-independent-assembler-features"><span class="toc-number">5.</span> <span class="toc-text">Machine-Independent Assembler Features</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#literal-%E5%AD%97%E5%AE%9A"><span class="toc-number">5.1.</span> <span class="toc-text">Literal (字定)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#symbol-defining-statements"><span class="toc-number">5.2.</span> <span class="toc-text">Symbol-Defining Statements</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#org-value"><span class="toc-number">5.2.1.</span> <span class="toc-text">ORG value</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#expressions"><span class="toc-number">5.3.</span> <span class="toc-text">Expressions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#program-blocks"><span class="toc-number">5.4.</span> <span class="toc-text">Program Blocks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#control-sections-and-program-linking"><span class="toc-number">6.</span> <span class="toc-text">Control Sections and Program Linking</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#figure-215"><span class="toc-number">6.1.</span> <span class="toc-text">Figure 2.15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#figure-216"><span class="toc-number">6.2.</span> <span class="toc-text">Figure 2.16</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#figure-217"><span class="toc-number">6.3.</span> <span class="toc-text">Figure 2.17</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="Related"><ul><li><a href="/2023/04/23/SystemSoftware/Appendix_A/" rel="bookmark" title="Appendix A">Appendix A</a></li><li><a href="/2023/04/24/SystemSoftware/Ch01_Background/" rel="bookmark" title="Ch01 - Background">Ch01 - Background</a></li><li><a href="/2023/04/25/SystemSoftware/Ch01_example/" rel="bookmark" title="Ch01 - Example">Ch01 - Example</a></li><li class="active"><a href="/2023/04/26/SystemSoftware/Ch02_Assembler/" rel="bookmark" title="Ch02 - Assemblers">Ch02 - Assemblers</a></li><li><a href="/2023/04/27/SystemSoftware/Ch02_example/" rel="bookmark" title="Ch02 - Example">Ch02 - Example</a></li><li><a href="/2023/05/23/SystemSoftware/Ch03_Loaders_and_Linkers/" rel="bookmark" title="Ch03 - Loaders and Linkers">Ch03 - Loaders and Linkers</a></li><li><a href="/2023/05/30/SystemSoftware/Ch04_Macro_Processors/" rel="bookmark" title="Ch04 - Macro Processors">Ch04 - Macro Processors</a></li></ul></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="ChienI Kao" data-src="/images/avatar.jpg"><p class="name" itemprop="name">ChienI Kao</p><div class="description" itemprop="description">This is a note blog</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">72</span> <span class="name">posts</span></a></div><div class="item categories"><a href="/categories/"><span class="count">18</span> <span class="name">categories</span></a></div><div class="item tags"><a href="/tags/"><span class="count">62</span> <span class="name">tags</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0NoaWVuSUthby9DaGllbklLYW8uZ2l0aHViLmlv" title="https:&#x2F;&#x2F;github.com&#x2F;ChienIKao&#x2F;ChienIKao.github.io"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOmFsZW45MTEwMThAZ21haWwuY29t" title="mailto:alen911018@gmail.com"><i class="ic i-envelope"></i></span> <span class="exturl item instagram" data-url="aHR0cHM6Ly9pbnN0YWdyYW0uY29tL2NoaWVuaV8xMDE4" title="https:&#x2F;&#x2F;instagram.com&#x2F;chieni_1018"><i class="ic i-instagram"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/04/26/Coding/leetcode/Easy/258%20Add%20Digits/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/04/26/Coding/uva/Star1/uva%20706/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Coding/" title="In Coding">Coding</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/" title="In Leetcode">Leetcode</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/Hard/" title="In Hard">Hard</a></div><span><a href="/2023/04/24/Coding/leetcode/Hard/1416%20Restore%20The%20Array/" title="1416. Restore The Array">1416. Restore The Array</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Coding/" title="In Coding">Coding</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/" title="In Leetcode">Leetcode</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/Easy/" title="In Easy">Easy</a></div><span><a href="/2023/05/08/Coding/leetcode/Easy/2635%20Apply%20Transform%20Over%20Each%20Element%20in%20Array/" title="2635. Apply Transform Over Each Element in Array">2635. Apply Transform Over Each Element in Array</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/SystemSoftware/" title="In SystemSoftware">SystemSoftware</a></div><span><a href="/2023/04/24/SystemSoftware/Ch01_Background/" title="Ch01 - Background">Ch01 - Background</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Algorithm/" title="In Algorithm">Algorithm</a></div><span><a href="/2023/04/25/Algorithm/Ch06%20Backtracking/" title="Ch05. Backtracking">Ch05. Backtracking</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/SystemSoftware/" title="In SystemSoftware">SystemSoftware</a></div><span><a href="/2023/05/23/SystemSoftware/Ch03_Loaders_and_Linkers/" title="Ch03 - Loaders and Linkers">Ch03 - Loaders and Linkers</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Programming/" title="In Programming">Programming</a> <i class="ic i-angle-right"></i> <a href="/categories/Programming/C-C/" title="In C/C++">C/C++</a></div><span><a href="/2023/04/20/programming/CPP/cpp%20queue/" title="C++ - queue">C++ - queue</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Programming/" title="In Programming">Programming</a> <i class="ic i-angle-right"></i> <a href="/categories/Programming/C-C/" title="In C/C++">C/C++</a></div><span><a href="/2023/04/21/programming/CPP/cpp%20vector/" title="C++ - vector">C++ - vector</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/SystemSoftware/" title="In SystemSoftware">SystemSoftware</a></div><span><a href="/2023/04/23/SystemSoftware/Appendix_A/" title="Appendix A">Appendix A</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Coding/" title="In Coding">Coding</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/" title="In Leetcode">Leetcode</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/Medium/" title="In Medium">Medium</a></div><span><a href="/2023/04/25/Coding/leetcode/Medium/2336%20Smallest%20Number%20in%20Infinite%20Set/" title="2336. Smallest Number in Infinite Set">2336. Smallest Number in Infinite Set</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Coding/" title="In Coding">Coding</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/" title="In Leetcode">Leetcode</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/Easy/" title="In Easy">Easy</a></div><span><a href="/2023/05/15/Coding/leetcode/Easy/2666%20Allow%20One%20Function%20Call/" title="2666. Allow One Function Call">2666. Allow One Function Call</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-ChienI Kao"></i> </span><span class="author" itemprop="copyrightHolder">ChienI Kao @ ChienI Kao</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="Symbols count total">194k words</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="Reading time total">2:57</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/04/26/SystemSoftware/Ch02_Assembler/",favicon:{show:"（●´3｀●）Goooood",hide:"(´Д｀)Booooom"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>