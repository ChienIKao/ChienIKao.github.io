<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Nothing is true, everything is permitted" href="https://chienikao.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Nothing is true, everything is permitted" href="https://chienikao.github.io/atom.xml"><link rel="alternate" type="application/json" title="Nothing is true, everything is permitted" href="https://chienikao.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="System Software,Assembler"><link rel="canonical" href="https://chienikao.github.io/2023/04/26/System%20Software/Ch02/Ch02_Assembler/"><title>Ch02 - Assemblers - Ch02 - System Software | ChienI Kao = Nothing is true, everything is permitted</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Ch02 - Assemblers</h1><div class="meta"><span class="item" title="Created: 2023-04-26 09:33:29"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2023-04-26T09:33:29+08:00">2023-04-26</time> </span><span class="item" title="Symbols count in article"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">Symbols count in article</span> <span>10k</span> <span class="text">words</span> </span><span class="item" title="Reading time"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">Reading time</span> <span>9 mins.</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ChienI Kao</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1gipexoj0moj20zk0m8kgu.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1giclhtuo6nj20zk0m8ttm.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1gipesrnqv3j20zk0m8ava.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1gicis3attqj20zk0m8k7l.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1gipeybxm1pj20zk0m8niv.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1giclxp31goj20zk0m8qv5.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/System-Software/" itemprop="item" rel="index" title="In System Software"><span itemprop="name">System Software</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/System-Software/Ch02/" itemprop="item" rel="index" title="In Ch02"><span itemprop="name">Ch02</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="en"><link itemprop="mainEntityOfPage" href="https://chienikao.github.io/2023/04/26/System%20Software/Ch02/Ch02_Assembler/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="ChienI Kao"><meta itemprop="description" content=", This is a note blog"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Nothing is true, everything is permitted"></span><div class="body md" itemprop="articleBody"><p><img data-src="https://i.imgur.com/hSiRp3g.png" alt=""></p><h2 id="introduction"><a class="anchor" href="#introduction">#</a> Introduction</h2><p>Design and implementation of assemblers</p><ul><li>Some <strong>common fundamental functions</strong> such as:<ul><li>translating <strong>mnemonic operation codes</strong> to their <strong>machine language</strong> equivalents</li><li>assigning machine <strong>addresses</strong> to <strong>symbolic labels</strong> used by the programmer.</li></ul></li><li>The features and design of an assembler depend heavily upon the source language it translates and the machine language it produces.</li><li><strong>Machine dependent/independent features</strong></li></ul><h2 id="basic-assembler-functions"><a class="anchor" href="#basic-assembler-functions">#</a> Basic Assembler Functions</h2><ul><li><p><a href="./Ch02%20-%20%E7%AF%84%E4%BE%8B%E7%A8%8B%E5%BC%8F.md"><strong>Example of SIC assembler language program</strong></a></p></li><li><p><strong>Assembler Directive</strong>: 在組語程式中，用來告訴 Assembler 某些資訊或是該做哪些動作，不屬於 CPU 的指令</p><ul><li><code>START</code> : specify <strong>name</strong> and <strong>starting address</strong> for the program.</li><li><code>END</code> : indicate the <strong>end of the source program</strong> and (optionally) specify the first executable instruction in the program.</li><li><strong>Variable/Constant Declaration</strong><ul><li><code>BYTE</code></li><li><code>WORD</code></li><li><code>RESB</code></li><li><code>RESW</code></li></ul></li></ul></li><li><p>The line numbers are for reference only and are not part of the program</p></li></ul><h3 id="a-simple-sic-assembler"><a class="anchor" href="#a-simple-sic-assembler">#</a> A Simple SIC Assembler</h3><ul><li>The translation of source program to object code requires us to accomplish the following functions<br>(not necessarily in the order given)<ol><li>Convert <strong>mnemonic operation codes</strong> to their machine <strong>language equivalents</strong><ul><li>translate STL to 14 (line 10)</li></ul></li><li>Convert <strong>symbolic operands</strong> to their equivalent <strong>machine addresses</strong><ul><li>translate RETADR to 1033 (line 10)</li></ul></li><li>Build the <strong>machine instruction</strong> in the <strong>proper format</strong>.</li><li>Convert the <strong>data constants</strong> specified in the source program into their <strong>internal machine representations</strong><ul><li>translate EOF to 454F46 (line 80)</li></ul></li><li><strong>Write the object program</strong> and the <strong>assembly listing</strong>.</li></ol></li></ul><h3 id="forward-reference-two-passes"><a class="anchor" href="#forward-reference-two-passes">#</a> Forward Reference &amp; Two Passes</h3><ul><li>The instruction at line 10 contains a <font>forward reference</font>.<ul><li>Line 10 存取 <code>RETADR</code> ，但 <code>RETADR</code> 在 line 95 才定義</li></ul></li><li>Because of forward reference, most assemblers make <strong>two passes</strong> over the source program.<ul><li><strong>The first pass</strong>:<ul><li>does little more than scan the source program for <strong>label definitions</strong> and <strong>assign addresses</strong>.</li></ul></li><li><strong>The second pass</strong>:<ul><li>performs most of the <strong>actual translation</strong> previously described.</li></ul></li></ul></li><li>In addition, the assembler must <strong>process statements</strong> called <font>assembler directives</font> (or <font>pseudo-instructions</font>).</li></ul><h3 id="simple-object-program"><a class="anchor" href="#simple-object-program">#</a> Simple Object Program</h3><ul><li>The simple object program format we use contains <strong>three types of records</strong>.<ul><li><strong>Header</strong><ul><li>program name</li><li>starting address</li><li>length</li></ul></li><li><strong>Text</strong><ul><li>translated instructions</li><li>data</li><li>indication of the addresses where these are to be loaded</li></ul></li><li><strong>End</strong><ul><li>marks the end of the object program</li><li>specifies the address in the program where execution is to begin</li></ul></li></ul></li></ul><p><strong>Header record</strong>:</p><ul><li>Col. 1: H</li><li>Col. 2-7: Program name</li><li>Col. 8-13: starting address of object program</li><li>Col. 14-19: length of object program in bytes</li></ul><p><strong>Text record</strong>:</p><ul><li>Col. 1: T</li><li>Col. 2-7: starting address for object code in this record</li><li>Col. 8-9: length of object code in this record in bytes</li><li>Col. 10-69: object code, represented in <strong>hexadecimal</strong></li></ul><div class="note info"><ul><li>Object code 的部分可以容納 60 個 <strong>symbol</strong>（每個 4 bit），若以 byte 計算就是 30 bytes。</li><li>一個 instruction 長 3 bytes，所以可以放 10 個 instructions</li><li>在指令不連續時（通常是中間有宣告變數），會在沒填滿的情況下使用新的 text record。</li></ul></div><p><strong>End record</strong>:</p><ul><li>Col.1: E</li><li>Col. 2-7: address of first executable instruction in object program</li></ul><p><img data-src="https://i.imgur.com/K3uyzDu.jpg" alt=""></p><ul><li>There is no object code corresponding to addresses 1033-2038.</li><li>This storage is simply reserved by the loader for use by the program during execution.</li></ul><h3 id="two-passes"><a class="anchor" href="#two-passes">#</a> Two Passes</h3><p><strong>Pass 1</strong> (define symbols):</p><ul><li><strong>Assign addresses</strong> to all <strong>statements</strong> in the program.</li><li>Save the values (addresses) assigned to all <strong>labels</strong> for use in Pass 2.</li><li>Perform some <strong>processing of assembler directives</strong>.<ul><li>e.g., <strong>determining the length of data areas</strong> defined by BYTE, RESW, etc.)</li></ul></li></ul><p><strong>Pass 2</strong> (assemble instructions and generate object program):</p><ul><li>Assemble <strong>instructions</strong> (translating operation codes and looking up addresses)</li><li>Generate <strong>data values</strong> defined by BYTE, WORD, etc.</li><li>Perform processing of assembler directives not done during Pass 1.</li><li>Write the object program and the assembly listing.</li></ul><h2 id="assembler-algorithm-and-data-structures"><a class="anchor" href="#assembler-algorithm-and-data-structures">#</a> Assembler Algorithm and Data Structures</h2><p>Major internal data structures of simple assembler:</p><ul><li><strong>Operation code table</strong> (OPTAB)</li><li>Symbol table (SYMTAB)</li><li>Location Counter (LOCCTR)<ul><li><strong>Initialized to the beginning address</strong> specified in the START statement.</li></ul></li></ul><h3 id="operation-code-table-optab"><a class="anchor" href="#operation-code-table-optab">#</a> Operation Code Table (OPTAB)</h3><ul><li>Contains (at least) the <strong>mnemonic operation code</strong> and its <strong>machine language equivalents</strong><ul><li>In more complex assemblers, this table also contains information about instruction format and length.</li></ul></li><li>OPTAB is usually organized as a <strong>hash table</strong>, with <strong>mnemonic operation code as the <font>key</font></strong>.<ul><li>The information in OPTAB is <strong>predefined</strong> when the assembler itself is written.</li></ul></li></ul><p><strong>Example of OPTAB</strong></p><table><thead><tr><th style="text-align:left">Mnemonic</th><th style="text-align:left">Machine Language</th></tr></thead><tbody><tr><td style="text-align:left"><code>ADD</code></td><td style="text-align:left">18</td></tr><tr><td style="text-align:left"><code>ADDF</code></td><td style="text-align:left">58</td></tr><tr><td style="text-align:left"><code>ADDR</code></td><td style="text-align:left">90</td></tr><tr><td style="text-align:left">…</td><td style="text-align:left">…</td></tr></tbody></table><div class="note info"><ul><li>Operation code table 的內容不太會變動</li><li>使用目的是用來加快 mnemonic <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">⇒</span></span></span></span> machine language 的速度<ul><li>需要使用<strong>查詢</strong>速度很快的資料結構</li></ul></li><li>所以會使用 Hash Table 來實作 OPTAB<ul><li>查詢的平均複雜度是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li></ul></li></ul></div><h3 id="symbol-table-symtab"><a class="anchor" href="#symbol-table-symtab">#</a> Symbol Table (SYMTAB)</h3><ul><li>Includes the <strong>name</strong> and <strong>value (address)</strong> for each <strong>label</strong> in the source program<ul><li>together with <strong>flags</strong> to indicate <font>error conditions</font><ul><li>e.g., a symbol defined in two different places</li></ul></li></ul></li><li>It may also contain other information about the data area or instruction labeled<ul><li>for example, its <strong>type</strong> or <strong>length</strong>.</li></ul></li><li>During <font>Pass 1</font><ul><li><strong>labels</strong> are entered into SYMTAB as they are encountered in the source program</li><li>along with their <strong>assigned addresses</strong>.</li></ul></li><li>During <font>Pass 2</font><ul><li>symbols used as <strong>operands</strong> are <strong>looked up in SYMTAB</strong><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">⇒</span></span></span></span> <strong>the addresses</strong> to be inserted in the assembled instructions.</li></ul></li><li>SYMTAB is usually organized as a <strong>hash table</strong><ul><li>for <strong>efficiency</strong> of <font>insertion</font> and <font>retrieval</font>.</li></ul></li><li>Since entries are rarely deleted from this table, efficiency of deletion is not an important consideration.</li></ul><p><strong>Example: SYMTAB of <a href="./Ch02%20-%20%E7%AF%84%E4%BE%8B%E7%A8%8B%E5%BC%8F.md">SIC Program</a></strong></p><table><thead><tr><th style="text-align:left">Label</th><th style="text-align:left">Location</th></tr></thead><tbody><tr><td style="text-align:left"><code>COPY</code></td><td style="text-align:left">1000</td></tr><tr><td style="text-align:left"><code>FIRST</code></td><td style="text-align:left">1000</td></tr><tr><td style="text-align:left"><code>CLOOP</code></td><td style="text-align:left">1003</td></tr><tr><td style="text-align:left"><code>ENDFIL</code></td><td style="text-align:left">1015</td></tr><tr><td style="text-align:left"><code>EOF</code></td><td style="text-align:left">102A</td></tr><tr><td style="text-align:left"><code>THREE</code></td><td style="text-align:left">102D</td></tr><tr><td style="text-align:left">…</td><td style="text-align:left">…</td></tr></tbody></table><div class="note info"><p>對 hash table 來說，<strong>insertion</strong> (插入) 和 <strong>retrieval</strong> (查詢)，平均複雜度都是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p></div><h3 id="hash-table"><a class="anchor" href="#hash-table">#</a> Hash Table</h3><ul><li>Care should be taken in the selection of a hashing function.<ul><li>Programmers often select many <strong>labels</strong> that have <strong>similar characteristics</strong><ul><li>for example, labels that start or end with the same characters (like LOOP1, LOOP2, LOOPA).</li></ul></li><li>It is important that the hashing function used perform well with such non-random keys.<ul><li>對於任意的 key，hash 的結果越不容易重複越好</li></ul></li><li>Division of the entire key by a <strong>prime table length</strong> often gives good results.</li></ul></li></ul><h3 id="algorithms-of-passes"><a class="anchor" href="#algorithms-of-passes">#</a> Algorithms of Passes</h3><p>Pass 1 usually writes an <font>intermediate file</font></p><ul><li>contains each <strong>source statement</strong> together with its <strong>assigned addresses</strong>, <strong>error indicators</strong>, etc.</li><li>This file is used <strong>as the input to Pass 2</strong>.</li></ul><p><strong>Pseudo Code of Pass1</strong></p><figure class="highlight vhdl"><figcaption data-lang="VHDL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">begin</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    read first input line</pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'START' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="5"></td><td><pre>            save #<span class="token punctuation">[</span>OPERAND<span class="token punctuation">]</span> as starting address</pre></td></tr><tr><td data-num="6"></td><td><pre>            initialize LOCCTR <span class="token keyword">to</span> starting address</pre></td></tr><tr><td data-num="7"></td><td><pre>            write line <span class="token keyword">to</span> intermediate <span class="token keyword">file</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            read <span class="token keyword">next</span> input line</pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> START<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        initialize LOCCTR <span class="token keyword">to</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">while</span> OPCODE !<span class="token operator">=</span> '<span class="token keyword">END</span>' do</pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token keyword">if</span> this <span class="token keyword">is</span> <span class="token operator">not</span> a comment line <span class="token keyword">then</span></pre></td></tr><tr><td data-num="15"></td><td><pre>                <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                    <span class="token keyword">if</span> there <span class="token keyword">is</span> a symbol <span class="token keyword">in</span> the <span class="token keyword">LABEL</span> field <span class="token keyword">then</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                            search SYMTAB <span class="token keyword">for</span> <span class="token keyword">LABEL</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                            <span class="token keyword">if</span> found <span class="token keyword">then</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                                set error flag <span class="token punctuation">(</span>duplicate symbol<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                            <span class="token keyword">else</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                                insert <span class="token punctuation">(</span><span class="token keyword">LABEL</span><span class="token punctuation">,</span> LOCCTR<span class="token punctuation">)</span> into SYMTAB</pre></td></tr><tr><td data-num="23"></td><td><pre>                        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> symbol<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                    search OPTAB <span class="token keyword">for</span> OPCODE</pre></td></tr><tr><td data-num="25"></td><td><pre>                    <span class="token keyword">if</span> found <span class="token keyword">then</span></pre></td></tr><tr><td data-num="26"></td><td><pre>                        add <span class="token number">3</span> <span class="token punctuation">&#123;</span>instruction length<span class="token punctuation">&#125;</span> <span class="token keyword">to</span> LOCCTR</pre></td></tr><tr><td data-num="27"></td><td><pre>                    <span class="token keyword">else</span> <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'WORD ' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                        add <span class="token number">3</span> <span class="token keyword">to</span> LOCCTR</pre></td></tr><tr><td data-num="29"></td><td><pre>                    <span class="token keyword">else</span> <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'RESW' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="30"></td><td><pre>                        add <span class="token number">3</span> <span class="token operator">*</span> #<span class="token punctuation">[</span>OPERAND<span class="token punctuation">]</span> <span class="token keyword">to</span> LOCCTR</pre></td></tr><tr><td data-num="31"></td><td><pre>                    <span class="token keyword">else</span> <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'RESB' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="32"></td><td><pre>                        add #<span class="token punctuation">[</span>OPERAND<span class="token punctuation">]</span> <span class="token keyword">to</span> LOCCTR</pre></td></tr><tr><td data-num="33"></td><td><pre>                    <span class="token keyword">else</span> <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'BYTE' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="34"></td><td><pre>                        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="35"></td><td><pre>                            find length <span class="token keyword">of</span> <span class="token keyword">constant</span> <span class="token keyword">in</span> bytes</pre></td></tr><tr><td data-num="36"></td><td><pre>                            add length <span class="token keyword">to</span> LOCCTR</pre></td></tr><tr><td data-num="37"></td><td><pre>                        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> BYTE<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="39"></td><td><pre>                        set error flag <span class="token punctuation">(</span>invalid operation code<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>                <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token operator">not</span> a comment<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>            write line <span class="token keyword">to</span> intermediate <span class="token keyword">file</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            read <span class="token keyword">next</span> input line</pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token operator">not</span> <span class="token keyword">END</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    write last line <span class="token keyword">to</span> intermediate <span class="token keyword">file</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    save <span class="token punctuation">(</span>LOCCTR <span class="token operator">-</span> starting address<span class="token punctuation">)</span> as program length</pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">end</span> <span class="token punctuation">&#123;</span>Pass <span class="token number">1</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>Presudo Code of Pass2</strong></p><figure class="highlight vhdl"><figcaption data-lang="VHDL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">begin</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    read first input line <span class="token punctuation">&#123;</span>from intermediate <span class="token keyword">file</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'START' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="5"></td><td><pre>            Write listing line</pre></td></tr><tr><td data-num="6"></td><td><pre>            read <span class="token keyword">next</span> input line</pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> START<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    write Header <span class="token keyword">record</span> <span class="token keyword">to</span> object program</pre></td></tr><tr><td data-num="9"></td><td><pre>    initialize first Text <span class="token keyword">record</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">while</span> OPCODE !<span class="token operator">=</span> '<span class="token keyword">END</span>' do</pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token keyword">if</span> this <span class="token keyword">is</span> <span class="token operator">not</span> a comment line <span class="token keyword">then</span></pre></td></tr><tr><td data-num="13"></td><td><pre>                <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="14"></td><td><pre>                    search OPTAB <span class="token keyword">for</span> OPCODE</pre></td></tr><tr><td data-num="15"></td><td><pre>                    <span class="token keyword">if</span> found <span class="token keyword">then</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                            <span class="token keyword">if</span> there <span class="token keyword">is</span> a symbol <span class="token keyword">in</span> OPERAND field <span class="token keyword">then</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                                <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                                    search SYMTAB <span class="token keyword">for</span> OPERAND</pre></td></tr><tr><td data-num="20"></td><td><pre>                                    <span class="token keyword">if</span> found <span class="token keyword">then</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                                        store symbol value as operand address</pre></td></tr><tr><td data-num="22"></td><td><pre>                                    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                                        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                                            store <span class="token number">0</span> as operand address</pre></td></tr><tr><td data-num="25"></td><td><pre>                                            set error flag <span class="token punctuation">(</span>undefined symbol<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>                                        <span class="token keyword">end</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                                <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> symbol<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                            <span class="token keyword">else</span></pre></td></tr><tr><td data-num="29"></td><td><pre>                                store <span class="token number">0</span> as operand address</pre></td></tr><tr><td data-num="30"></td><td><pre>                            assemble the object code instruction</pre></td></tr><tr><td data-num="31"></td><td><pre>                        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> opcode found<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>                    <span class="token keyword">else</span> <span class="token keyword">if</span> OPCODE <span class="token operator">=</span> 'BYTE' <span class="token operator">or</span> 'WORD' <span class="token keyword">then</span></pre></td></tr><tr><td data-num="33"></td><td><pre>                        convert <span class="token keyword">constant</span> <span class="token keyword">to</span> object code</pre></td></tr><tr><td data-num="34"></td><td><pre>                    <span class="token keyword">if</span> object code will <span class="token operator">not</span> fit into the current Text <span class="token keyword">record</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="35"></td><td><pre>                        <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="36"></td><td><pre>                            write Text <span class="token keyword">record</span> <span class="token keyword">to</span> object program</pre></td></tr><tr><td data-num="37"></td><td><pre>                            initialize <span class="token keyword">new</span> Text <span class="token keyword">record</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                        <span class="token keyword">end</span></pre></td></tr><tr><td data-num="39"></td><td><pre>                    add object code <span class="token keyword">to</span> Text <span class="token keyword">record</span></pre></td></tr><tr><td data-num="40"></td><td><pre>                <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token operator">not</span> comment <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>            write listing line</pre></td></tr><tr><td data-num="42"></td><td><pre>            read <span class="token keyword">next</span> input line</pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">end</span> <span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token operator">not</span> <span class="token keyword">END</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    write last Text <span class="token keyword">record</span> <span class="token keyword">to</span> object program</pre></td></tr><tr><td data-num="45"></td><td><pre>    write <span class="token keyword">End</span> <span class="token keyword">record</span> <span class="token keyword">to</span> object program</pre></td></tr><tr><td data-num="46"></td><td><pre>    write last listing line</pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">end</span> <span class="token punctuation">&#123;</span>Pass <span class="token number">2</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="machine-dependent-assembler-features"><a class="anchor" href="#machine-dependent-assembler-features">#</a> Machine-Dependent Assembler Features</h2><ul><li><p><a href="./Ch02%20-%20%E7%AF%84%E4%BE%8B%E7%A8%8B%E5%BC%8F.md"><strong>Example of SIC/XE Program</strong></a></p></li><li><p>The <strong>assembler directive</strong> <code>BASE</code> is used in conjunction with <strong>base relative addressing</strong>.</p><ul><li>用 <code>BASE</code> 讓 assembler 知道 base register 的值</li><li>Assembler 必須知道 base 的值，才能計算指令中的 displacement</li></ul></li><li><p>If the <strong>displacements</strong> required for relative addressing are <strong>too large</strong> to fit into a <strong>3-byte instruction</strong><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">⇒</span></span></span></span> the <strong>4-byte extended format</strong> (Format 4) must be used.</p><ul><li>The <strong>bit e is set to 1</strong> to indicate extended instruction format.</li><li>The extended instruction format is <strong>specified with the prefix +</strong> added to the <strong>operation code</strong> in the <font>source statement</font>.</li><li>It is the <strong>programmer’s responsibility to specify</strong> this form of addressing when it is required.</li></ul></li><li><p>Advantages of the more advanced SIC/XE architecture to improve the execution speed of the program</p><ul><li><strong>Register-to-register instructions</strong> are faster than register-to-memory operations.</li><li>When using <strong>immediate addressing</strong>, the operand is already present as part of the instruction and <strong>need not be fetched from anywhere</strong>.</li><li>The use of <strong>indirect addressing</strong> often <strong>avoids the need for another instruction</strong>.</li></ul></li></ul><h3 id="instruction-formats-and-addressing-modes"><a class="anchor" href="#instruction-formats-and-addressing-modes">#</a> Instruction Formats and Addressing Modes</h3><ul><li><p>The conversion of <strong>register mnemonics</strong> to numbers can be done with a separate table</p><ul><li>however, it is often convenient to use the <strong>symbol table</strong> for this purpose.</li><li>To do this, SYMTAB would <strong>be preloaded with the register names</strong> and their values.</li></ul></li><li><p>If extended format is not specified, the assembler <strong>first</strong> attempts to translate the instruction using <strong>program-counter relative addressing</strong>.</p><ul><li>If this is not possible (because the required displacement is out of range), the assembler then attempts to use <strong>base relative addressing</strong>.</li><li>If neither form of relative addressing is applicable and extended format is not specified, then the instruction cannot be properly assembled.<ul><li>In this case, the assembler must generate an <font>error message</font>.</li></ul></li></ul></li></ul><h3 id="displacement-calculation"><a class="anchor" href="#displacement-calculation">#</a> Displacement Calculation</h3><ul><li>The computation that the assembler needs to perform is essentially the target address calculation in reverse.<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>p</mi><mo>=</mo><mi>T</mi><mi>A</mi><mo>−</mo><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">disp = TA - (B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>p</mi><mo>=</mo><mi>T</mi><mi>A</mi><mo>−</mo><mo stretchy="false">(</mo><mi>P</mi><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">disp = TA - (PC)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><p><strong>PC Relative</strong></p><ul><li>The program counter is advanced after each instruction is fetched and before it is executed.<ul><li>Thus during the execution of an instruction, program counter will contain <strong>the address of the next instruction</strong>.</li></ul></li><li>The assembler knows what the contents of the program counter will be at execution time.</li></ul><p><strong>Base Relative</strong></p><ul><li>The base register is under control of the programmer.</li><li>The programmer must tell the assembler what the base register will contain during execution<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">⇒</span></span></span></span> so that the assembler can compute displacements.<ul><li>This is done with the <strong>assembler directive <code>BASE</code> </strong>.</li><li><code>NOBASE</code></li><li>These assembler directives produce no executable code.</li><li>The programmer must provide instructions that load the proper value into the base register during execution.</li></ul></li></ul><h2 id="machine-independent-assembler-features"><a class="anchor" href="#machine-independent-assembler-features">#</a> Machine-Independent Assembler Features</h2><h3 id="literal-字定"><a class="anchor" href="#literal-字定">#</a> Literal (字定)</h3><ul><li><p>A literal is identified with the prefix <code>=</code> , which is followed by a specification of the literal value, using the same notation as in the <em>BYTE</em> statement.</p></li><li><p>The effect of using a literal is exactly the same as if the programmer had defined the <strong>constant</strong> explicitly and used the label assigned to the constant as the instruction operand.</p></li><li><p>Difference between a literal and an immediate operand</p><ul><li>With <strong>immediate</strong> addressing, the operand value is assembled as part of the machine instruction.<figure class="highlight vhdl"><figcaption data-lang="VHDL"></figcaption><table><tr><td data-num="1"></td><td><pre>Line 	Loc 	   Source statement	 	Object code 	 </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">55</span> 	<span class="token number">0020</span> 		LDA    #<span class="token number">3</span> 		<span class="token number">010003</span></pre></td></tr></table></figure></li><li>With a <strong>literal</strong>, the assembler generates the specified value as a constant at some other memory location.<figure class="highlight vhdl"><figcaption data-lang="VHDL"></figcaption><table><tr><td data-num="1"></td><td><pre>Line 	Loc 	   Source statement	 	Object code 	 </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">45</span> 	<span class="token number">001</span>A 	ENDFIL 	LDA    <span class="token operator">=</span>C<span class="token attribute attr-name">'EOF</span>' 		<span class="token number">032010</span></pre></td></tr></table></figure></li></ul></li><li><p>All of the literal operands used in a program are gathered together into one or more <span class="red">literal pools</span>.</p></li><li><p>In some case, it is desirable to place literals into a pool at some other location in the object program.</p><ul><li>ex. avoiding having to use extended format instructions when referring to the literals.</li></ul><figure class="highlight vhdl"><figcaption data-lang="VHDL"></figcaption><table><tr><td data-num="1"></td><td><pre>Line 	Loc 	   Source statement	 	Object code 	 </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">93</span> 			        LTORG 			 </pre></td></tr><tr><td data-num="3"></td><td><pre>	    <span class="token number">002</span>D 	<span class="token operator">*</span>      <span class="token operator">=</span>C<span class="token attribute attr-name">'EOF</span>' 			<span class="token number">454</span>F46</pre></td></tr></table></figure></li></ul><div class="tags"><a href="/tags/System-Software/" rel="tag"><i class="ic i-tag"></i> System Software</a> <a href="/tags/Assembler/" rel="tag"><i class="ic i-tag"></i> Assembler</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">Edited on</span> <time title="Modified: 2023-05-03 13:59:12" itemprop="dateModified" datetime="2023-05-03T13:59:12+08:00">2023-05-03</time></span></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>ChienI Kao <i class="ic i-at"><em>@</em></i>Nothing is true, everything is permitted</li><li class="link"><strong>Post link: </strong><a href="https://chienikao.github.io/2023/04/26/System%20Software/Ch02/Ch02_Assembler/" title="Ch02 - Assemblers">https://chienikao.github.io/2023/04/26/System Software/Ch02/Ch02_Assembler/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/04/26/Coding/leetcode/Easy/258%20Add%20Digits/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;21r000-image.oss-cn-shanghai.aliyuncs.com&#x2F;pic2021&#x2F;6833939bly1gicivghyooj20zk0m8dir.jpg" title="258. Add Digits"><span class="type">Previous Post</span> <span class="category"><i class="ic i-flag"></i> Easy</span><h3>258. Add Digits</h3></a></div><div class="item right"><a href="/2023/04/26/System%20Software/Ch01/Ch01_Background/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;21r000-image.oss-cn-shanghai.aliyuncs.com&#x2F;pic2021&#x2F;6833939bly1giclfb3vzhj20zk0m8wny.jpg" title="Ch01 - Background"><span class="type">Next Post</span> <span class="category"><i class="ic i-flag"></i> Ch01</span><h3>Ch01 - Background</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#basic-assembler-functions"><span class="toc-number">2.</span> <span class="toc-text">Basic Assembler Functions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#a-simple-sic-assembler"><span class="toc-number">2.1.</span> <span class="toc-text">A Simple SIC Assembler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#forward-reference-two-passes"><span class="toc-number">2.2.</span> <span class="toc-text">Forward Reference &amp; Two Passes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#simple-object-program"><span class="toc-number">2.3.</span> <span class="toc-text">Simple Object Program</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#two-passes"><span class="toc-number">2.4.</span> <span class="toc-text">Two Passes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#assembler-algorithm-and-data-structures"><span class="toc-number">3.</span> <span class="toc-text">Assembler Algorithm and Data Structures</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#operation-code-table-optab"><span class="toc-number">3.1.</span> <span class="toc-text">Operation Code Table (OPTAB)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#symbol-table-symtab"><span class="toc-number">3.2.</span> <span class="toc-text">Symbol Table (SYMTAB)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hash-table"><span class="toc-number">3.3.</span> <span class="toc-text">Hash Table</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#algorithms-of-passes"><span class="toc-number">3.4.</span> <span class="toc-text">Algorithms of Passes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#machine-dependent-assembler-features"><span class="toc-number">4.</span> <span class="toc-text">Machine-Dependent Assembler Features</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#instruction-formats-and-addressing-modes"><span class="toc-number">4.1.</span> <span class="toc-text">Instruction Formats and Addressing Modes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#displacement-calculation"><span class="toc-number">4.2.</span> <span class="toc-text">Displacement Calculation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#machine-independent-assembler-features"><span class="toc-number">5.</span> <span class="toc-text">Machine-Independent Assembler Features</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#literal-%E5%AD%97%E5%AE%9A"><span class="toc-number">5.1.</span> <span class="toc-text">Literal (字定)</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="Related"><ul><li><a href="/2023/04/26/System%20Software/Ch02/Ch02_example/" rel="bookmark" title="Ch02 - Example">Ch02 - Example</a></li><li class="active"><a href="/2023/04/26/System%20Software/Ch02/Ch02_Assembler/" rel="bookmark" title="Ch02 - Assemblers">Ch02 - Assemblers</a></li></ul></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="ChienI Kao" data-src="/images/avatar.jpg"><p class="name" itemprop="name">ChienI Kao</p><div class="description" itemprop="description">This is a note blog</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">49</span> <span class="name">posts</span></a></div><div class="item categories"><a href="/categories/"><span class="count">18</span> <span class="name">categories</span></a></div><div class="item tags"><a href="/tags/"><span class="count">52</span> <span class="name">tags</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0NoaWVuSUthby9DaGllbklLYW8uZ2l0aHViLmlv" title="https:&#x2F;&#x2F;github.com&#x2F;ChienIKao&#x2F;ChienIKao.github.io"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOmFsZW45MTEwMThAZ21haWwuY29t" title="mailto:alen911018@gmail.com"><i class="ic i-envelope"></i></span> <span class="exturl item instagram" data-url="aHR0cHM6Ly9pbnN0YWdyYW0uY29tL2NoaWVuaV8xMDE4" title="https:&#x2F;&#x2F;instagram.com&#x2F;chieni_1018"><i class="ic i-instagram"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/04/26/Coding/leetcode/Easy/258%20Add%20Digits/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/04/26/System%20Software/Ch01/Ch01_Background/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Coding/" title="In Coding">Coding</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/UVA/" title="In UVA">UVA</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/UVA/Star1/" title="In Star1">Star1</a></div><span><a href="/2023/04/21/Coding/uva/Star1/uva%20630/" title="uva 630 - Anagrams (II)">uva 630 - Anagrams (II)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Algorithm/" title="In Algorithm">Algorithm</a></div><span><a href="/2023/04/25/Algorithm/Backtracking/" title="Backtracking">Backtracking</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Algorithm/" title="In Algorithm">Algorithm</a></div><span><a href="/2023/04/19/Algorithm/%E9%BE%9C%E5%85%94%E8%B3%BD%E8%B7%91/" title="龜兔賽跑算法">龜兔賽跑算法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Coding/" title="In Coding">Coding</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/" title="In Leetcode">Leetcode</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/Easy/" title="In Easy">Easy</a></div><span><a href="/2023/05/07/Coding/leetcode/Easy/2667%20Create%20Hello%20World%20Function/" title="2667. Create Hello World Function">2667. Create Hello World Function</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Coding/" title="In Coding">Coding</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/" title="In Leetcode">Leetcode</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/Easy/" title="In Easy">Easy</a></div><span><a href="/2023/04/24/Coding/leetcode/Easy/1046%20Last%20Stone%20Weight/" title="1046. Last Stone Weight">1046. Last Stone Weight</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Coding/" title="In Coding">Coding</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/" title="In Leetcode">Leetcode</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/Medium/" title="In Medium">Medium</a></div><span><a href="/2023/05/07/Coding/leetcode/Medium/1456%20Maximum%20Number%20of%20Vowels%20in%20a%20Substring%20of%20Given%20Length/" title="1456. Maximum Number of Vowels in a Substring of Given Length">1456. Maximum Number of Vowels in a Substring of Given Length</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Coding/" title="In Coding">Coding</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/UVA/" title="In UVA">UVA</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/UVA/Star1/" title="In Star1">Star1</a></div><span><a href="/2023/04/21/Coding/uva/Star1/uva%20591/" title="uva 591 - Box of Bricks">uva 591 - Box of Bricks</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="In Web">Web</a> <i class="ic i-angle-right"></i> <a href="/categories/Web/CSS/" title="In CSS">CSS</a></div><span><a href="/2023/04/19/Web/CSS/CSS%20-%20Float/" title="CSS - Float">CSS - Float</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Coding/" title="In Coding">Coding</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/" title="In Leetcode">Leetcode</a> <i class="ic i-angle-right"></i> <a href="/categories/Coding/Leetcode/Easy/" title="In Easy">Easy</a></div><span><a href="/2023/05/03/Coding/leetcode/Easy/2215%20Find%20the%20Difference%20of%20Two%20Arrays/" title="2215. Find the Difference of Two Arrays">2215. Find the Difference of Two Arrays</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Web/" title="In Web">Web</a> <i class="ic i-angle-right"></i> <a href="/categories/Web/CSS/" title="In CSS">CSS</a></div><span><a href="/2023/04/18/Web/CSS/CSS%20-%20Animation/" title="CSS - Animation">CSS - Animation</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-ChienI Kao"></i> </span><span class="author" itemprop="copyrightHolder">ChienI Kao @ ChienI Kao</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="Symbols count total">128k words</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="Reading time total">1:57</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/04/26/System Software/Ch02/Ch02_Assembler/",favicon:{show:"（●´3｀●）Goooood",hide:"(´Д｀)Booooom"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>